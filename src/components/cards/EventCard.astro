---
import { Image } from "astro:assets";
import { ArrowRight, Calendar, MapPin } from "@lucide/astro";

const { name, date, location, cover, link } = Astro.props;
const formattedDate = new Date(date).toLocaleDateString("en-US", {
  year: "numeric",
  month: "short",
  day: "numeric",
});

const eventDate = new Date(date);
const today = new Date();
today.setHours(0, 0, 0, 0);

let status = "";
let statusColor = "";

if (eventDate.toDateString() === today.toDateString()) {
  status = "Today";
  statusColor = "bg-primary text-white";
} else if (eventDate > today) {
  status = "Upcoming";
  statusColor = "bg-blue-600 text-white";
} else {
  status = "";
}
---

<a
  href={`/events/${link}`}
  class="group grid grid-cols-1 md:grid-cols-12 gap-4 md:gap-8 items-center py-6 md:py-12 border-b border-gray-300 dark:border-gray-100 last:border-0"
>
  <!-- Graphical Date (Left) -->
  <div class="hidden md:flex flex-col md:col-span-2 items-center justify-center pr-6 h-full">
    <span class="text-5xl font-black text-gray-400 group-hover:text-primary transition-colors duration-500 leading-none">
      {new Date(date).getDate().toString().padStart(2, '0')}
    </span>
    <span class="text-sm font-bold uppercase tracking-widest text-gray-500 mt-2">
      {new Date(date).toLocaleString('default', { month: 'short' })}
    </span>
  </div>

  <!-- Image (Middle - Wider) -->
  <div class="relative aspect-video w-full md:col-span-5 overflow-hidden bg-gray-200 dark:bg-gray-800 shadow-sm">
    {
      cover && (
        <Image
          src={cover}
          alt={name}
          class="h-full w-full object-cover transition-transform duration-700 group-hover:scale-105"
          format="webp"
          loading="lazy"
          quality={90}
        />
      )
    }
  </div>

  <!-- Content (Right) -->
  <div class="flex flex-col md:col-span-5 py-2 gap-6">
    <div>
      <div class="flex items-center justify-between mb-3">
        <!-- New Date for Mobile -->
        <div class="md:hidden flex items-center gap-2 text-xs font-bold uppercase tracking-widest text-primary">
          <Calendar size={14} />
          <span>{formattedDate}</span>
        </div>
        
        {status && (
           <span class={`px-3 py-1 text-[10px] font-bold uppercase tracking-wider rounded-full ${status === 'Upcoming' ? 'bg-primary/10 text-primary' : 'bg-gray-100 text-gray-500 dark:bg-white/10 dark:text-gray-400'}`}>
            {status}
           </span>
        )}
      </div>

      <h2 class="mb-3 text-xl md:text-3xl font-black leading-tight text-gray-900 dark:text-white group-hover:text-primary transition-colors">
        {name}
      </h2>

      {location && (
        <div class="flex items-center gap-2 text-sm font-medium text-gray-500 dark:text-gray-400">
          <MapPin size={16} />
          <span>{location}</span>
        </div>
      )}
    </div>

    <div class="flex items-center gap-2 text-xs font-bold uppercase tracking-widest text-gray-900 dark:text-white group-hover:text-primary transition-colors">
      Read More <ArrowRight size={14} class="transition-transform duration-300 group-hover:translate-x-2" />
    </div>
  </div>
</a>