---
import { Image } from "astro:assets";

const {
  title,
  description,
  cover,
  date,
  link,
  highlight = false,
  author,
} = Astro.props;

const formattedDate = new Date(date).toLocaleDateString("en-US", {
  year: "numeric",
  month: "short",
  day: "numeric",
});

const wordCount = description?.split(' ').length || 100;
const readTime = Math.max(1, Math.ceil(wordCount / 200));
---

<a
  href={`/blogs/${link}`}
  class={`group overflow-hidden cursor-pointer transition-all duration-200 hover:scale-[1.005] block break-inside-avoid mb-4 bg-card shadow-md ${highlight ? "lg:col-span-2 lg:row-span-2" : ""}`}
>
  <div class="relative">
    {
      cover && (
        <Image
          src={cover}
          alt={title}
          class="w-full h-auto object-contain bg-gray-100"
          width={1280}
          height={720}
          format="webp"
          loading="lazy"
          quality={80}
        />
      )
    }
  </div>

  <div class={`p-4 space-y-2 ${highlight ? "p-6" : ""}`}>
    <div class="flex items-center gap-2 text-sm text-muted-foreground">
      <span>{formattedDate}</span>
      <span>•</span>
      <span>{readTime} min read</span>
      {
        author && (
          <>
            <span>•</span>
            <span>{author}</span>
          </>
        )
      }
    </div>

    <h2
      class={`font-bold leading-tight transition-colors group-hover:text-primary ${highlight ? "text-2xl" : "text-xl"}`}
    >
      {title}
    </h2>

    {
      highlight && description && (
        <p class="text-muted-foreground text-sm line-clamp-3">
          {description}
        </p>
      )
    }
  </div>
</a>
