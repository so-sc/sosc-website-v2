---
import Layout from "@/layouts/Layout.astro";
import Hero from "@/components/Hero.astro";
import BlogCard from "@/components/cards/BlogCard.astro";
import Cover from "@/assets/cover/blog.jpg";
import { getCollection } from "astro:content";
import slugify from "slugify";

const blogs = await getCollection("blogs");

const parsedBlogs = blogs
  .map(({ data }) => ({
    title: data.title,
    author: data.author,
    date: data.date,
    description: data.description,
    cover: data.cover,
    tags: data.tags,
    link: slugify(data.title, { lower: true, strict: true }),
  }))
  .sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime());
---

<Layout>
  <Hero
    image={Cover}
    title="Blogs"
    subtitle="Dive into articles, insights, and updates from our community."
  />

  <section
    class="bg-background text-foreground mx-auto max-w-7xl space-y-6 px-4 py-16 md:px-8"
  >
    <!-- Featured + Grid Layout -->
    <div class="grid grid-cols-1 gap-4 lg:grid-cols-3">
      {parsedBlogs.slice(0, 6).map((blog, index) => (
        <BlogCard {...blog} highlight={index === 0} />
      ))}
    </div>

    <!-- Rest of the blogs in 3-column grid -->
    <div class="grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3">
      {parsedBlogs.slice(6).map((blog) => <BlogCard {...blog} />)}
    </div>
  </section>
</Layout>
